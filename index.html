<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Speed2 Ultra</title>
    <link rel="manifest" href="manifest.json">
    <style>
        body { margin: 0; background: #0a0a0a; color: white; font-family: sans-serif; overflow: hidden; touch-action: none; }
        #menu { position: absolute; top: 10px; left: 10px; background: rgba(0,0,0,0.85); padding: 12px; border: 1px solid #ff0000; border-radius: 8px; z-index: 100; width: 200px; box-shadow: 0 0 15px rgba(255,0,0,0.3); }
        .label { font-size: 10px; color: #ff4444; font-weight: bold; margin-top: 8px; text-transform: uppercase; letter-spacing: 1px; }
        input { width: 100%; accent-color: #ff0000; margin: 5px 0 10px 0; cursor: pointer; }
        #stat { font-family: monospace; font-size: 9px; color: #888; border-top: 1px solid #333; pt: 5px; margin-top: 5px; }
        .fov-indicator { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); border: 1px dashed rgba(255,0,0,0.2); border-radius: 50%; pointer-events: none; }
    </style>
</head>
<body>
    <div id="menu">
        <div class="label">NO RECOIL FORCE</div>
        <input type="range" id="recoil" min="0" max="10" step="0.1" value="2.1">
        
        <div class="label">STABILIZER (JITTER)</div>
        <input type="range" id="jitter" min="0" max="1" step="0.01" value="0.12">

        <div class="label">AIM ASSIST MAGNÃ‰TICO</div>
        <input type="range" id="assist" min="0" max="1" step="0.05" value="0.45">
        
        <div id="stat">SPEED2 STATUS: CALIBRATING...</div>
    </div>

    <div class="fov-indicator" id="fov" style="width: 100px; height: 100px;"></div>

    <script type="module">
        import { SensEngine } from './engine.js';
        const engine = new SensEngine();
        const stat = document.getElementById('stat');
        const fov = document.getElementById('fov');

        // Controles
        document.getElementById('recoil').oninput = (e) => engine.config.recoilForce = parseFloat(e.target.value);
        document.getElementById('jitter').oninput = (e) => engine.config.recoilJitter = parseFloat(e.target.value);
        document.getElementById('assist').oninput = (e) => {
            engine.config.assistStrength = parseFloat(e.target.value);
            const size = 50 + (engine.config.assistStrength * 100);
            fov.style.width = size + 'px';
            fov.style.height = size + 'px';
        };

        window.addEventListener('pointerdown', () => engine.setFiring(true));
        window.addEventListener('pointerup', () => engine.setFiring(false));

        window.addEventListener('pointermove', (e) => {
            const targetX = window.innerWidth / 2;
            const targetY = window.innerHeight / 2;
            
            const res = engine.processMove(e.clientX, e.clientY, targetX, targetY);
            stat.innerText = `COORD X:${res.x.toFixed(1)} Y:${res.y.toFixed(1)} | ACTIVE`;
        }, { passive: true });

        if ('serviceWorker' in navigator) navigator.serviceWorker.register('./sw.js');
    </script>
</body>
</html>